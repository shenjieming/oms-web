<div class="row" ng-controller="DealwithController">
    <div class="tools">
        <h5 style="float:left; font-weight:bold; margin-left:8px;">
            <i class="fa fa-file-archive-o"></i>
            手术订单
            <span style="color: #0033FF">[{{sono}}]</span>
            <span style="color: #FF3300">({{PageData.statusName}})</span>
        </h5>
        <span style="float:right;">
            <a class="btn btn-primary" ng-show="View.Competence.dealwith" ng-click="DealService.Submit()"><i class="fa fa-wrench"></i>处理</a>
            <a class="btn btn-primary" ng-click="goLastPage()"><i class="fa fa-reply"></i> 返回</a>
        </span>
    </div>
    <div ng-img="img" ng-model="file" style="height:0px;width:0px;"></div>
    <div ng-materials="" ng-model="PageData.prodLns" ng-operat="MaterialsConfig.operat" ng-line="ProductConfig.useLine.medProdLnCode" ng-change="ProductConfig.useLine.medMaterias"></div>
    <div ng-productline="{{PageData.sOCreateByOrgCode}}" ng-model="PageData.prodLns" ng-operat="ProductConfig.operat" ng-cargo-model="PageData.sOOIOrgCode"></div>

    <div>
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active" href="#Original" data-toggle="tab"><a>原始订单</a></li>
            <li role="presentation" href="#Dealwith" data-toggle="tab"><a>开始处理</a></li>
        </ul>
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="Original">
                <div ui-view="Original"></div>
            </div>
            <div class="tab-pane" id="Dealwith">
                <div class="row-fluid">
                    <div class="widget-box">
                        <div class="widget-title bg_ly">
                            <span class="icon"><i class="fa icon-chevron-down"></i></span>
                            <h5 data-toggle="collapse" href="#pro_BaseInformation" style="width:80%">基础信息[货主：{{PageData.sOOIOrgCodeName}}]</h5>
                            <a class="btn" ng-click="AddressConfig.show()"><i class="fa fa-map-marker"></i>修改地址</a>
                        </div>
                        <div class="widget-content nopadding collapse in" id="pro_BaseInformation">
                            <div class="control-group ">
                                <label style="line-height:28px;">
                                    收 货 人：{{PageData.deliveryContact}}
                                </label>
                                <label style="line-height:28px;">
                                    联系电话：{{PageData.deliveryrMobile}}
                                </label>
                                <label>
                                    <span class="required">*</span>配送方式：
                                    <span ng-dictionary="TRANTP" ng-model="PageData.carrierTransType"></span>
                                </label>
                            </div>
                            <div class="control-group ">
                                <label style="width:100%">
                                    <span>  收货地址：</span>
                                    <span>
                                        {{PageData.deliveryProvinceName}}
                                        {{PageData.deliveryCityName}}
                                        {{PageData.deliveryDistrictName}}
                                        {{PageData.deliveryAddress}}
                                    </span>
                                </label>
                            </div>
                        </div>
                        <div ng-address="address" ng-model="PageData" ng-operat="AddressConfig"></div>
                    </div>

                    <div class="widget-box">
                        <div class="widget-title bg_ly">
                            <span class="icon"><i class="fa icon-chevron-down"></i></span>
                            <h5 data-toggle="collapse" style="width:80%" href="#pro_SurgeryInformation">手术信息</h5>
                            <a class="btn" ng-click="HospitalConfig.show()"><i class="fa fa-reddit-square"></i>修改医生</a>
                        </div>
                        <div id="pro_SurgeryInformation" class="widget-content nopadding collapse in">
                            <div class="control-group ">
                                <label>
                                    医院名称：{{PageData.hPCodeName}}
                                </label>
                                <label>
                                    科室名称：{{PageData.wardDeptCodeName}}
                                </label>
                                <label>
                                    医生名称：{{PageData.dTCodeName}}<span style="color:green">[{{PageData.isLocalName}}]</span>
                                </label>
                            </div>
                            <div class="control-group">
                                <label style="width:100%;">
                                    医院要求：{{PageData.hPPreferenceDesc}}
                                </label>
                            </div>
                            <div class="control-group">
                                <label style="width:100%;">
                                    医生要求：{{PageData.dTOperationPreferenceDesc}}
                                </label>
                            </div>
                            <div class="control-group">
                                <label>
                                    <span class="required">*</span>
                                    <span style="float:left;line-height:32px;">手术时间：</span>
                                    <div class="input-group" style="float:left;width:180px;">
                                        <input type="text" class="form-control" placeholder="请选择手术时间"
                                               style="padding:8px;" ng-datatime="" ng-model="PageData.operationDate">
                                        <div class="input-group-addon"><i class="fa fa-calendar"></i></div>
                                    </div>
                                </label>
                                <label style="width:60%">
                                    <span class="required">*</span>
                                    诊断信息：<input type="text" style=" width:78%" ng-model="PageData.patientDiseaseInfo" />
                                </label>
                            </div>
                            <div class="control-group ">
                                <label style="width:100%;">
                                    患者描述:
                                    <input type="text" style="width: 78%" ng-model="PageData.patientRemark" />
                                </label>
                            </div>
                            <div class="control-group " style="display:none;">
                                <label style="width:100%">
                                    备注信息：<input style="width:78%" type="text" />
                                </label>
                            </div>
                            <div ng-doctors="" ng-model="PageData" ng-operat="HospitalConfig"></div>
                        </div>
                    </div>

                    <div class="widget-box">
                        <div class="widget-title bg_ly">
                            <span class="icon"><i class="fa icon-chevron-down"></i></span>
                            <h5 style="width:80%" data-toggle="collapse" href="#pro_ProductInformation">产品信息</h5>
                            <a href="javascript:void(0)" class="btn" style="display:none;"><i class="fa fa-folder-open"></i>选择模板</a>
                        </div>
                        <div id="pro_ProductInformation" class="widget-content nopadding collapse in">
                            <div class="control-group">
                                <div style="width:100%;">
                                    <span style=" color: #808080; line-height:30px;margin-left:25px" ng-show="!PageData.medKits.length">未使用套件，您可以添加您配置好的套件</span>
                                    <a class="btn btn-warning" ng-click="MedKitsConfig.operat.show()" style="float:right;margin-right:10px;"><i class="fa fa-arrows"></i>添加套件</a>
                                </div>
                                <div ng-med-kits="med" ng-model="MedKitsConfig.useData" ng-operat="MedKitsConfig.operat" ng-cargo-model="PageData.sOOIOrgCode"></div>
                            </div>
                            <div class="control-group" ng-show="PageData.medKits.length">
                                <div class="main-box-body clearfix" style="padding: 15px; max-height: 450px; overflow: auto; width: 100%;">
                                    <div class="table-responsive">
                                        <table class="table table-bordered tab-striped">
                                            <thead>
                                                <tr>
                                                    <th><span>序号</span></th>
                                                    <th><span>套件编码</span></th>
                                                    <th><span>套件名称</span></th>
                                                    <th><span>套件类型</span></th>
                                                    <th><span>使用数量</span></th>
                                                    <th><span>所在仓库</span></th>
                                                    <th><span><a href="javascript:void(0)" ng-click="WarehouseConfig.GetKitInventory()"><i class="fa fa-cubes"></i> 全部库存</a> </span> </th>
                                                    <th><span>库区</span></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="row in PageData.medKits">
                                                    <td>{{$index+1}}</td>
                                                    <td>
                                                        {{row.kitCode}}
                                                    </td>
                                                    <td>
                                                        {{row.kitName}}
                                                    </td>
                                                    <td>
                                                        {{row.kitTypeName}}
                                                    </td>
                                                    <td>
                                                        <input type="number" value="0" ng-model="row.reqQty" style="width:60px" min="0" />
                                                    </td>
                                                    <td>
                                                        <select ng-model="row.estMedMIWarehouse" ng-change="WarehouseConfig.GetKitInventory(row)" ng-options="item.id as item.text for item in WarehouseConfig.WarehouseList">
                                                            <option value="">请选择仓库</option>
                                                        </select>
                                                    </td>
                                                    <td>
                                                        <a href="javascript:void(0)" ng-click="WarehouseConfig.GetKitInventory(row)">{{row.inventory?row.inventory:"当前库存"}}</a>
                                                    </td>
                                                    <td>
                                                        {{row.zoneName}}
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="control-group">

                                <div class="col-lg-3">
                                    <div class="control-group" style="display:block;">
                                        <a class="btn btn-warning" ng-click="ProductConfig.operat.show()"><i class="fa fa-medkit"></i>加产品线</a>
                                        <a class="btn btn-danger" ng-click="ProductConfig.deleteLine()"><i class="fa fa-scissors"></i>删除</a>
                                        <div id="ProductConfig" ng-tree="" ng-show="PageData.prodLns.length" ng-setting="ProductConfig.tree.setting" ng-data="ProductConfig.tree.data" ng-model="ProductConfig.tree.obj"></div></span>
                                    </div>
                                </div>
                                <div class="col-lg-9" ng-show="PageData.prodLns.length">
                                    <div class="control-group">
                                        <label> 品牌名称：{{ProductConfig.useLine.medBrandCodeName}}</label>
                                        <label style="width:32%;">产品线名称：{{ProductConfig.useLine.medProdLnCodeName}}</label>
                                        <label ng-show="">
                                            <span style="float:left">工具情况：</span>
                                            <input type="checkbox" id="checkbox" class="chkbox"
                                                   ng-checked="ProductConfig.useLine.isChecked" ng-model="ProductConfig.useLine.isChecked">
                                            <label for="checkbox" style="float:left"></label>
                                            <span ng-show="ProductConfig.useLine.isChecked">需要</span>
                                            <span ng-show="!ProductConfig.useLine.isChecked">不需要</span>
                                        </label>
                                    </div>
                                    <div class="control-group">
                                        <label style="width:90%">
                                            备注信息：{{ProductConfig.useLine.remark}}
                                        </label>
                                        <a class="btn btn-warning" ng-click="MaterialsConfig.operat.show()"><i class="fa fa-link"></i>添加物料</a>
                                    </div>
                                    <div class="control-group" ng-show="!ProductConfig.useLine.medMaterias.length">
                                        <label style="width:100%;color:red;">未配置物料，请对当前产品线添加物料...</label>
                                    </div>
                                    <span ng-show="ProductConfig.useLine.medMaterias.length">
                                        <div class="control-group">
                                            <div style="display: inline-block; width: 99%; padding: 5px;">
                                                <a class="btn btn-primary" ng-click="MaterialsConfig.GetShowMaterial()"><i class="fa fa-puzzle-piece"></i> 全部</a>
                                                <a class="btn btn-primary" ng-click="MaterialsConfig.GetShowMaterial('IMPLANT')"><i class="fa fa-puzzle-piece"></i> 植入物</a>
                                                <a class="btn btn-primary" ng-click="MaterialsConfig.GetShowMaterial('TOOL')"><i class="fa fa-wrench"></i> 工具</a>
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <div class="main-box-body clearfix" style="max-height: 350px; overflow: auto; width: 100%;">
                                                <div class="table-responsive">
                                                    <table class="table table-bordered tab-striped">
                                                        <thead>
                                                            <tr>
                                                                <th><span>序号</span></th>
                                                                <th><span>物料编码</span></th>
                                                                <th><span>物料名称</span></th>
                                                                <th><span>物料类型</span></th>
                                                                <th><span>物料规格</span></th>
                                                                <th><span>使用数量</span></th>
                                                                <th><span>使用仓库</span> </th>
                                                                <th><span><a href="javascript:void(0)" ng-click="WarehouseConfig.GetMedmaterialInventory()"><i class="fa fa-cubes"></i> 全部库存</a> </span> </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr ng-repeat="row in MaterialsConfig.Material">
                                                                <td>{{$index+1}}</td>
                                                                <td>
                                                                    {{row.medMICode}}
                                                                </td>
                                                                <td>
                                                                    {{row.medMIName}}
                                                                </td>
                                                                <td>
                                                                    {{row.categoryByPlatformName}}
                                                                </td>
                                                                <td>
                                                                    {{row.specification}}
                                                                </td>
                                                                <td>
                                                                    <input type="number" value="0" ng-model="row.reqQty" style="width:60px" min="0" />
                                                                </td>
                                                                <td>
                                                                    <select ng-model="row.medMIWarehouse" ng-change="WarehouseConfig.GetMedmaterialInventory(row)" ng-options="item.id as item.text for item in WarehouseConfig.WarehouseList">
                                                                        <option value="">请选择仓库</option>
                                                                    </select>
                                                                </td>
                                                                <td>
                                                                    <a href="javascript:void(0)" ng-click="WarehouseConfig.GetMedmaterialInventory(row)">{{row.inventory?row.inventory:"当前库存"}}</a>   
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </span>
                                </div>

                                <label style="width:100%;color:red;" ng-show="!PageData.prodLns.length">为选择产品线，请添加产品线...</label>
                            </div>
                        </div>
                    </div>
                    <div class="widget-box">
                        <div class="widget-title bg_ly">
                            <span class="icon"><i class="fa icon-chevron-down"></i></span>
                            <h5 data-toggle="collapse" style="width:80%" href="#pro_AdditionalInformation">图片信息</h5>
                            <a class="btn j_file_panel" href="javascript:void(0)">
                                <i class="fa fa-image"></i>
                                添加图片
                                <div ng-file="file" ng-model="file"></div>
                            </a>
                        </div>
                        <div id="pro_AdditionalInformation" class="widget-content nopadding collapse in">
                            <div class="control-group ">
                                <div ng-img="img" ng-model="PageData.attachments.images"></div>
                                <label style="opacity:0.5;width:100%;" ng-show="!PageData.attachments.images.length">
                                    添加点图片丰富您的订单吧，
                                    最多支持上传5张图片
                                </label>
                            </div>
                            <div class="control-group">
                                <label style="width:100%">
                                    图片说明：<input type="text" style="width:78%;" placeholder="对您的图片说点什么吧..." ng-model="PageData.attachments.remark" />
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="tools">
        <span style="float:right;">
            <a class="btn btn-primary" ng-show="View.Competence.dealwith" ng-click="DealService.Submit()"><i class="fa fa-wrench"></i>处理</a>
            <a class="btn btn-primary" ng-click="goLastPage()"><i class="fa  fa-reply"></i> 返回</a>
        </span>
    </div>
</div>
